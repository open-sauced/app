[build.environment]
NODE_VERSION = "18"
NETLIFY_NEXT_PLUGIN_SKIP = "true"

[build]
command = "echo 'deploying downtime page...'"
publish = "public"

[context.alpha]
environment = { CHANNEL = "alpha" }

[context.beta]
environment = { CHANNEL = "beta" }

[dev]
command = "next dev -p 3001"
port = 3000
targetPort = 3001

[functions]
deno_import_map = "./netlify/edge-functions/deno.json"

[[redirects]]
from = "https://insight.opensauced.pizza/*"
to = "https://insights.opensauced.pizza/:splat"
status = 301
force = true

[[redirects]]
from = "https://insights.opensauced.pizza/*"
to = "https://app.opensauced.pizza/:splat"
status = 301
force = true

[[redirects]]
from = "https://beta.insights.opensauced.pizza/*"
to = "https://beta.app.opensauced.pizza/:splat"
status = 301
force = true

[[redirects]]
from = "https://oscr.me/:username"
to = "https://app.opensauced.pizza/u/:username/card"
status = 301
force = true

[[redirects]]
from = "https://hot.opensauced.pizza/*"
to = "https://app.opensauced.pizza/explore"
status = 301
force = true

[[redirects]]
from = "/"
to = "/downtime.html"
status = 200
force = true

[[redirects]]
from = "/*"
to = "/downtime.html"
status = 302
force = true

[[redirects]]
from = "/downtime.html"
to = "/downtime.html"
status = 302
force = true
